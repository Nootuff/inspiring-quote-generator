const photographer = document.getElementById("photographer");

const backgroundData = [ //These are all the details of the images in the imgs folder.
  {
    photographer: "Alex Green",
    credit: "https://unsplash.com/@alreadygreen",
    link: "https://unsplash.com/photos/OdEdGWr0EkM"
  },
  {
    photographer: "Casey Horner",
    credit: "https://unsplash.com/@mischievous_penguins",
    link: "https://unsplash.com/photos/vPiz8ZQ9Wf8"
  },
  {
    photographer: "David Billings",
    credit: "https://unsplash.com/@dav_billings",
    link: "https://unsplash.com/photos/Zmfz5jqgSiI"
  },
  {
    photographer: "Jeremy Bishop",
    credit: "https://unsplash.com/@jeremybishop",
    link: "https://unsplash.com/photos/2e3hgvDnCpM"
  },
  {
    photographer: "Michael Baccin",
    credit: "https://unsplash.com/@michaelbaccin",
    link: "https://unsplash.com/photos/Cv5ooHwI2DQ"
  },
  {
    photographer: "Thom Milkovic",
    credit: "https://unsplash.com/@thommilkovic",
    link: "https://unsplash.com/photos/sGj7xKpukpQ"
  },
  {
    photographer: "Nathan Anderson",
    credit: "https://unsplash.com/@nathananderson",
    link: "https://unsplash.com/photos/_tBeFVZPlPY"
  },
  {
    photographer: "Taneli Lahtinen",
    credit: "https://unsplash.com/@tanelah",
    link: "https://unsplash.com/photos/ycmLVgeIUPE"
  },
  {
    photographer: "Todd Trapani",
    credit: "https://unsplash.com/@ttrapani",
    link: "https://unsplash.com/photos/fdDFCnUOleg"
  },
  {
    photographer: "Zetong Li",
    credit: "https://unsplash.com/@zetong",
    link: "https://unsplash.com/photos/7pUHeP1GRC4"
  }
];

let prevNum = ""

const numGen = () => {
  let randBackground = Math.floor(Math.random() * backgroundData.length);
  return randBackground;
}

const quoteGen = () => {
  let backgroundGen = numGen();

  if (prevNum == backgroundGen) { //This prevents the same background image being used twice in a row.
    backgroundGen = numGen(); //If backgroundGen matches the previously generated number, generate a new one. 
  }

  prevNum = backgroundGen;

  axios.get('https://gist.githubusercontent.com/camperbot/5a022b72e96c4c9585c32bf6a75f62d9/raw/e3c6895ce42069f0ee7e991229064f167fe8ccdc/quotes.json') //This is the api call.
    .then((body) => {
      let rand = Math.floor(Math.random() * body.data.quotes.length); //Generates the number to select from the quotes array. 
      let quoteText = "\"" + body.data.quotes[rand].quote + "\"";  
      let authorText = body.data.quotes[rand].author;
      $(".animText").animate({ opacity: "0" }, function () { //Jquery fades out the elements that will be changed. 
        document.getElementById("quote").textContent = quoteText; //Quote data sent to the dom. 
        document.getElementById("author").textContent = authorText;
        document.getElementById("imgLink").href = backgroundData[backgroundGen].link; //The details of the background image are sent to the dom to credit the original photographer.
        photographer.textContent = backgroundData[backgroundGen].photographer; 
        photographer.href = backgroundData[backgroundGen].credit;
        $(".animText").animate({ opacity: "1" }); //Changed elements fade back in.
      })
      $("#backgroundContainer").animate({ opacity: "0" }, function () { 
        document.getElementById("backgroundContainer").style.backgroundImage = `url("./imgs/${backgroundGen}.jpg")`; //The number generated by backgroundGen is used to choose an image from the imgs folder. 
        $("#backgroundContainer").animate({ opacity: "1" });
      })
      $("#tweet-quote").attr("href", `https://twitter.com/intent/tweet?text=${quoteText}: ${authorText}&hashtags=inspirational`); //Twitter link updated with new quote data.
    })
    .catch((err) => {
      console.log("Error", err.statusCode);
    })
};

window.onload = function () {
  quoteGen();
}